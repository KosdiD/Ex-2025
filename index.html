<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>Smart Home Tour with NavMesh Constraint</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v7.5.4/dist/aframe-extras.min.js"></script>
    
    <script src="simple-navmesh-constraint.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.11.0/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/speech-commands@0.5.4/dist/speech-commands.min.js"></script>
    
    <link rel="stylesheet" href="style.css">

</head>
<body>
    <div id="controls-panel">
        <div class="control-group">
            <strong>üéÆ –í–∏—Å–æ—Ç–∞ –≥—Ä–∞–≤—Ü—è:</strong><br>
            <button onclick="changeHeight(-1)">‚Üì</button>
            <input type="number" id="height-input" value="6" step="0.1" min="0" max="50">
            <button onclick="changeHeight(1)">‚Üë</button>
            <button onclick="setHeight()">–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏</button><br>
            <small>–ü–æ—Ç–æ—á–Ω–∞ –≤–∏—Å–æ—Ç–∞: <span id="current-height">6</span>–º</small>
        </div>
        <div class="control-group">
            <strong>üí° –ö–µ—Ä—É–≤–∞–Ω–Ω—è —Å–≤—ñ—Ç–ª–æ–º:</strong><br>
            <button onclick="createLight()">‚ûï –°—Ç–≤–æ—Ä–∏—Ç–∏ —Å–≤—ñ—Ç–ª–æ</button>
            <button onclick="toggleAllLights()">üí° –£–≤—ñ–º–∫/–í–∏–º–∫ –≤—Å—ñ</button>
            <div class="brightness-control">
                <label>–Ø—Å–∫—Ä–∞–≤—ñ—Å—Ç—å:</label>
                <input type="range" id="brightness-slider" min="0" max="100" value="50" onchange="updateBrightness(this.value)">
                <span id="brightness-value">50%</span>
            </div>
        </div>
        <div class="control-group" style="display: none;">
            <strong>üß± –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å—Ç—ñ–Ω:</strong><br>
            <button id="start-wall-btn" onclick="startWallCreation()">–ü–æ—á–∞—Ç–∏ —Å—Ç—ñ–Ω—É</button>
            <button id="create-wall-btn" onclick="createWall()" disabled>–ó–∞–≤–µ—Ä—à–∏—Ç–∏ —Å—Ç—ñ–Ω—É</button>
            <button id="cancel-wall-btn" onclick="cancelWallCreation()" disabled>–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
            <small id="wall-status">–í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –ø–æ—á–∞—Ç–∫–æ–≤—É —Ç–æ—á–∫—É.</small>
        </div>
        <div class="control-group">
            <strong>üìç –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–∞—Ä–∫–µ—Ä—ñ–≤:</strong><br>
            <button onclick="createMarkerAtCurrentPosition()">–°—Ç–≤–æ—Ä–∏—Ç–∏ –º–∞—Ä–∫–µ—Ä —Ç—É—Ç</button>
            <div id="marker-form" style="display: none;">
                <select id="ml-device-type" style="width: 100%; margin: 5px 0; padding: 5px;">
                    <option value="">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π IoT</option>
                    <option value="vision">üëÅÔ∏è Computer Vision</option>
                    <option value="audio">üîä –ê—É–¥—ñ–æ ML</option>
                    <option value="sensor">üìä –°–µ–Ω—Å–æ—Ä–Ω–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞</option>
                    <option value="motion">üèÉ –î–µ—Ç–µ–∫—Ç–æ—Ä —Ä—É—Ö—É</option>
                    <option value="climate">üå°Ô∏è –ö–ª—ñ–º–∞—Ç ML</option>
                    <option value="light">üí° –†–æ–∑—É–º–Ω–µ —Å–≤—ñ—Ç–ª–æ</option>
                </select>
                <input type="text" id="marker-name" placeholder="–ù–∞–∑–≤–∞ –ø—Ä–∏—Å—Ç—Ä–æ—é">
                <textarea id="marker-description" placeholder="–û–ø–∏—Å –ø—Ä–∏—Å—Ç—Ä–æ—é" rows="3"></textarea>
                <button onclick="saveMarker()">‚úÖ –ó–±–µ—Ä–µ–≥—Ç–∏</button>
                <button onclick="cancelMarker()">‚ùå –°–∫–∞—Å—É–≤–∞—Ç–∏</button>
            </div>
        </div>
        <div class="control-group">
            <strong>üè† –®–≤–∏–¥–∫—ñ –¥—ñ—ó:</strong><br>
            <button onclick="resetPosition()">‚Ü©Ô∏è –ù–∞ –ø–æ—á–∞—Ç–æ–∫</button>
            <button onclick="toggleMarkers()">üëÅÔ∏è –ü–æ–∫–∞–∑–∞—Ç–∏/–°—Ö–æ–≤–∞—Ç–∏</button>
        </div>
        <div class="control-group">
            <strong>üíæ –ï–∫—Å–ø–æ—Ä—Ç/–Ü–º–ø–æ—Ä—Ç:</strong><br>
            <button onclick="exportData()">üì• –ï–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –≤—Å–µ</button>
            <button onclick="document.getElementById('import-file').click()">üì§ –Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –≤—Å–µ</button>
            <input type="file" id="import-file" accept=".json" style="display: none;" onchange="importData(event)">
        </div>
    </div>
    <a-scene background="color: #87CEEB" fog="type: linear; color: #87CEEB; near: 10; far: 100">
        <a-assets>
            <a-asset-item id="house-model" src="box.glb"></a-asset-item>
            <a-asset-item id="navmesh-glb" src="navmesh.glb"></a-asset-item>
        </a-assets>

        <a-light type="ambient" intensity="0.6" id="ambient-light"></a-light>
        <a-light type="directional" position="20 40 20" intensity="0.8" castShadow="true"></a-light>
        
        <a-plane position="0 0 0" rotation="-90 0 0" width="200" height="200"
                 color="#4a5d4a" shadow="receive: true"></a-plane>

        <a-gltf-model src="#house-model" shadow="cast: true; receive: true" id="house"></a-gltf-model>
        
        <a-gltf-model class="navmesh" src="#navmesh-glb" visible="false"></a-gltf-model>

        <a-entity id="rig" position="0 6 10"
                  movement-controls="speed: 0.15;"
                  simple-navmesh-constraint="navmesh: .navmesh; height: 6;">
            <a-entity id="camera"
                      camera
                      position="0 6 0"
                      look-controls="pointerLockEnabled: true">
                <a-cursor></a-cursor>
            </a-entity>
        </a-entity>
        
        </a-scene>

    <script src="script.js"></script>
</body>
</html>
